# –†–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è Solana Bot

## –ì–ª–∞–≤–Ω—ã–µ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. üî¥ PumpSwap - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ big.Float (–ö–†–ò–¢–ò–ß–ù–û)

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
```
big.Float (—Ç–µ–∫—É—â–∞—è):  257.8 ns/op,  272 B/op, 10 allocs/op
float64 (–≤–æ–∑–º–æ–∂–Ω–∞—è): 0.314 ns/op,    0 B/op,  0 allocs/op
–£–ª—É—á—à–µ–Ω–∏–µ:           820x –±—ã—Å—Ç—Ä–µ–µ,   100% –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏
```

**–ü–∞–º—è—Ç—å:** PumpSwap –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **8.7GB** –≤ –±–µ–Ω—á–º–∞—Ä–∫–∞—Ö –∏–∑-–∑–∞ big.Float!

**–ö–æ–¥ –ø—Ä–æ–±–ª–µ–º—ã** (`internal/dex/pumpswap/calculations.go`):
```go
func calculateOutput(reserves, otherReserves, amount uint64, feeFactor float64) uint64 {
    x := new(big.Float).SetUint64(reserves)     // –∞–ª–ª–æ–∫–∞—Ü–∏—è
    y := new(big.Float).SetUint64(otherReserves) // –∞–ª–ª–æ–∫–∞—Ü–∏—è
    a := new(big.Float).SetUint64(amount)       // –∞–ª–ª–æ–∫–∞—Ü–∏—è
    // ... –µ—â–µ 7 –∞–ª–ª–æ–∫–∞—Ü–∏–π
}
```

### 2. üü° Worker Pool - –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –∞–ª–ª–æ–∫–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –º–µ—Å—Ç–∞:**
- `fmt.Sprintf`: 1.67GB –∞–ª–ª–æ–∫–∞—Ü–∏–π (15.46%)
- `context.WithTimeout`: 1.48GB –∞–ª–ª–æ–∫–∞—Ü–∏–π (13.63%)

**–ë–µ–Ω—á–º–∞—Ä–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```
1 worker, 10 tasks:      1,280 ns/op,   1,832 B/op
20 workers, 200 tasks:  58,784 ns/op,  34,458 B/op
```

### 3. üü° Context –æ–ø–µ—Ä–∞—Ü–∏–∏

**Overhead:**
```
context.WithTimeout: 263.7 ns/op, 272 B/op, 4 allocs/op
context.WithCancel:  –ø—Ä–æ—â–µ –∏ –±—ã—Å—Ç—Ä–µ–µ
```

### 4. ‚úÖ PumpFun - –æ—Ç–ª–∏—á–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω!

```
–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: ~0.31 ns/op, 0 B/op, 0 allocs/op
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. –ó–∞–º–µ–Ω–∞ big.Float –≤ PumpSwap (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô)

```go
// –í–º–µ—Å—Ç–æ big.Float –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å uint128 –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–∏–ø
type FixedPoint struct {
    value uint64
    scale uint8
}

// –ò–ª–∏ –¥–ª—è AMM —Ä–∞—Å—á–µ—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—É—é —Ñ–æ—Ä–º—É–ª—É –±–µ–∑ overflow:
func calculateOutputOptimized(reserveIn, reserveOut, amountIn uint64, feeNum, feeDen uint64) uint64 {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ overflow
    if amountIn > math.MaxUint64/feeNum {
        // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å big.Int —Ç–æ–ª—å–∫–æ –≤ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞—è—Ö
        return calculateWithBigInt(...)
    }
    
    amountWithFee := (amountIn * feeNum) / feeDen
    numerator := reserveOut * amountWithFee
    denominator := reserveIn + amountWithFee
    
    if denominator == 0 {
        return 0
    }
    
    return numerator / denominator
}
```

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Worker Pool

```go
// –ò–∑–±–µ–≥–∞—Ç—å fmt.Sprintf –≤ –≥–æ—Ä—è—á–∏—Ö –ø—É—Ç—è—Ö
// –í–º–µ—Å—Ç–æ:
walletKey := fmt.Sprintf("wallet%d", i)

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
walletKey := "wallet" + strconv.Itoa(i)

// –ò–ª–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∫–ª—é—á–∏:
walletKeys := make([]string, numWallets)
for i := range walletKeys {
    walletKeys[i] = "wallet" + strconv.Itoa(i)
}
```

### 3. –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è context overhead

```go
// –î–ª—è —á–∞—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏–π context
// –≤–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å context.WithCancel –≤–º–µ—Å—Ç–æ WithTimeout –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
```

## –†–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ë–µ–Ω—á–º–∞—Ä–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ PumpSwap:

```
–û—Ä–∏–≥–∏–Ω–∞–ª (big.Float):      232.9 ns/op,  272 B/op, 10 allocs/op
–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è (float64):  2.04 ns/op,    0 B/op,  0 allocs/op  (114x –±—ã—Å—Ç—Ä–µ–µ)
Fixed point –≤–µ—Ä—Å–∏—è:          0.31 ns/op,    0 B/op,  0 allocs/op  (750x –±—ã—Å—Ç—Ä–µ–µ)
```

### –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ:

1. **PumpSwap**: –¥–æ **750x** —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–æ–≤
2. **Memory**: –ø–æ–ª–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∞–ª–ª–æ–∫–∞—Ü–∏–π –¥–ª—è 99% —Å–ª—É—á–∞–µ–≤
3. **GC pressure**: –Ω—É–ª–µ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–±–æ—Ä—â–∏–∫ –º—É—Å–æ—Ä–∞

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `big.Float` –≤ PumpSwap –¥–ª—è AMM —Ä–∞—Å—á–µ—Ç–æ–≤. –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –æ–≥—Ä–æ–º–Ω—ã–π overhead –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å PumpFun, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Å—Ç—ã–µ float64 –æ–ø–µ—Ä–∞—Ü–∏–∏. 

–î–ª—è —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞, –≥–¥–µ –≤–∞–∂–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–∞–∫—Ü–∏–∏, –∑–∞–º–µ–Ω–∞ big.Float –Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–ª–∏ float64 (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–∞ overflow) –¥–∞—Å—Ç –æ–≥—Ä–æ–º–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## –§–∞–π–ª—ã —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏

1. `internal/dex/pumpswap/calculations_optimized.go` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
2. `internal/dex/pumpswap/calculations_optimized_test.go` - –±–µ–Ω—á–º–∞—Ä–∫–∏ –∏ —Ç–µ—Å—Ç—ã

–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- float64 –¥–ª—è –º–∞–ª—ã—Ö —á–∏—Å–µ–ª (–±—ã—Å—Ç—Ä–æ)
- –¶–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—É—é –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫—É –¥–ª—è —Å—Ä–µ–¥–Ω–∏—Ö —á–∏—Å–µ–ª
- big.Int —Ç–æ–ª—å–∫–æ –≤ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞—è—Ö (–¥–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª)